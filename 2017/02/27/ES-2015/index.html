<!doctype html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/my-blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/my-blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/my-blog/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="javascript,ES2015,ES6," />








  <link rel="shortcut icon" type="image/x-icon" href="/my-blog/favicon.ico?v=5.1.0" />






<meta name="description" content="A better length method for unicode text1234function codePointLen(text) &amp;#123;  let result = text.match(/[\s\S]/gu);  return result ? result.length : 0;&amp;#125; Default paramA trivial version1234function">
<meta name="keywords" content="javascript,ES2015,ES6">
<meta property="og:type" content="article">
<meta property="og:title" content="ES2015">
<meta property="og:url" content="https://sevenbamboos.github.com/2017/02/27/ES-2015/index.html">
<meta property="og:site_name" content="Sam&#39;s Chest of Drawers">
<meta property="og:description" content="A better length method for unicode text1234function codePointLen(text) &amp;#123;  let result = text.match(/[\s\S]/gu);  return result ? result.length : 0;&amp;#125; Default paramA trivial version1234function">
<meta property="og:updated_time" content="2017-03-18T03:43:15.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ES2015">
<meta name="twitter:description" content="A better length method for unicode text1234function codePointLen(text) &amp;#123;  let result = text.match(/[\s\S]/gu);  return result ? result.length : 0;&amp;#125; Default paramA trivial version1234function">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/my-blog/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://sevenbamboos.github.com/2017/02/27/ES-2015/"/>





  <title> ES2015 | Sam's Chest of Drawers </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/my-blog/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Sam's Chest of Drawers</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Thinking about Programming and Lifestyle</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/my-blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/my-blog/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/my-blog/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/my-blog/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://sevenbamboos.github.com/my-blog/2017/02/27/ES-2015/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuping Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://s.gravatar.com/avatar/67a6b6bab2f6f4fb0f035c398789a241?s=80">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sam's Chest of Drawers">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                ES2015
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-27T22:59:32+08:00">
                02-27-2017
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/my-blog/categories/Programming/" itemprop="url" rel="index">
                    <span itemprop="name">Programming</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="A-better-length-method-for-unicode-text"><a href="#A-better-length-method-for-unicode-text" class="headerlink" title="A better length method for unicode text"></a>A better length method for unicode text</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">codePointLen</span>(<span class="params">text</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> result = text.match(<span class="regexp">/[\s\S]/gu</span>);</div><div class="line">  <span class="keyword">return</span> result ? result.length : <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Default-param"><a href="#Default-param" class="headerlink" title="Default param"></a>Default param</h2><p>A trivial version<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getID</span>(<span class="params">name, defaultValue</span>) </span>&#123;</div><div class="line">  defaultValue = defaultValue || <span class="number">1000</span>;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>The problem is defaultValue would be ignored with falsy value like 0. As a result, a more decent version before ES2015 is<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getID</span>(<span class="params">name, defaultValue</span>) </span>&#123;</div><div class="line">  defaultValue = (<span class="keyword">typeof</span> defaultValue !== <span class="string">"undefined"</span>) ? defaultValue : <span class="number">0</span>;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>In ES2015, it can be simplified as<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getID</span>(<span class="params">name, defaultValue=<span class="number">1000</span></span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<h2 id="Apply-call-and-array-destructuring"><a href="#Apply-call-and-array-destructuring" class="headerlink" title="Apply, call and array destructuring"></a>Apply, call and array destructuring</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> values = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>];</div><div class="line"></div><div class="line"><span class="comment">// Because Math.max doesn't accept array. Please remember that "call" accepts multiple params and do the same function invocation as "apply" </span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.max.apply(<span class="built_in">Math</span>, values));</div><div class="line"></div><div class="line"><span class="comment">// The first param can be anything since max is a pure function (instead of a method)</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.max.apply(<span class="literal">null</span>, values));</div><div class="line"></div><div class="line"><span class="comment">// But it's easier with array destructuring</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.max(...values));</div></pre></td></tr></table></figure>
<h2 id="How-to-check-whether-a-function-is-called-with-“new”"><a href="#How-to-check-whether-a-function-is-called-with-“new”" class="headerlink" title="How to check whether a function is called with “new”"></a>How to check whether a function is called with “new”</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">this</span> <span class="keyword">instanceof</span> Person) &#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Call Person with new, please"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> Person(<span class="string">"tom"</span>);</div><div class="line"></div><div class="line"><span class="comment">// It can be checked by Person and throw the error</span></div><div class="line"><span class="comment">// let p2 = Person("jerry");</span></div><div class="line"></div><div class="line"><span class="comment">// No error with this call </span></div><div class="line"><span class="keyword">let</span> p2 = Person.call(p1, <span class="string">"jerry"</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(p1.name); <span class="comment">//jerry</span></div><div class="line"><span class="built_in">console</span>.log(p2); <span class="comment">//undefined</span></div></pre></td></tr></table></figure>
<p>ES2015 fixes the issue with:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="comment">// "new.target" is not supported in safari (on iPhone, iPad and Mac)</span></div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">new</span>.target !== <span class="string">"undefined"</span>) &#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Call Person with new, please"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Note that if we can modify the above comparison to create an abstract class<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="keyword">new</span>.target === Person) </div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Abstract class Person can't be initilized directly"</span>);</div></pre></td></tr></table></figure></p>
<h2 id="Differences-between-arrow-function-and-normal-one"><a href="#Differences-between-arrow-function-and-normal-one" class="headerlink" title="Differences between arrow function and normal one"></a>Differences between arrow function and normal one</h2><ul>
<li>No this, super and new.target bindings; No prototype and arguments</li>
<li>Can’t be called with new (since arrow function doesn’t have [[Construct]], only [[Call]])</li>
<li>Can’t change this, which remains the same throughout the life cycle of the function</li>
</ul>
<h2 id="Tail-call-optimization"><a href="#Tail-call-optimization" class="headerlink" title="Tail call optimization"></a>Tail call optimization</h2><p>In theory, the optimization is enabled when the tail call has no dependency to the current stack and there is no further work to do after the call, plus the call must return as the function value. So this won’t be optimized:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fact</span>(<span class="params">n</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> n * fact(n<span class="number">-1</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>In fact, I notice it is quite efficient (in safari on Mac). fact(170), the maximum param making the result less than infinity, is as fast as below, which is regarded as optimized:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fact</span>(<span class="params">n, p=<span class="number">1</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>*p;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> fact(n<span class="number">-1</span>, n*p);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Here is another example:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fibo</span>(<span class="params">n, i=<span class="number">2</span>, p1=<span class="number">1</span>, p2=<span class="number">1</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"param n can't be less than zero"</span>);</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">2</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">if</span> (n === i) &#123;</div><div class="line">      <span class="keyword">return</span> p1 + p2;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> fibo(n, i+<span class="number">1</span>, p1+p2, p1);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Property-Initializer"><a href="#Property-Initializer" class="headerlink" title="Property Initializer"></a>Property Initializer</h2><p>No need in ES2015 to repeat the value assignment for each property. The eigine will look for the variable in the surrounding context with the same name and do the job.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPerson</span>(<span class="params">name, age</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    name,</div><div class="line">    age</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Two-ways-to-clone-an-array"><a href="#Two-ways-to-clone-an-array" class="headerlink" title="Two ways to clone an array"></a>Two ways to clone an array</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> list = [<span class="string">"dog"</span>, <span class="string">"cat"</span>, <span class="string">"Sam"</span>];</div><div class="line"><span class="keyword">let</span> another = list.concat();</div><div class="line"><span class="keyword">let</span> second = [...list];</div></pre></td></tr></table></figure>
<h2 id="Make-the-last-param-optional-to-provide-multiple-configuration"><a href="#Make-the-last-param-optional-to-provide-multiple-configuration" class="headerlink" title="Make the last param optional to provide multiple configuration"></a>Make the last param optional to provide multiple configuration</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">config</span>(<span class="params">id, value, options = &#123;&#125;</span>) </span>&#123;</div><div class="line">	<span class="keyword">let</span> &#123;<span class="attr">core</span>:&#123;name&#125;, time=<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.now()), user=<span class="string">"Unknown User"</span>&#125; = options; </div><div class="line">	<span class="keyword">return</span> &#123;name,time,user&#125;;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> options = config(<span class="number">1</span>, <span class="string">"abc"</span>, &#123;<span class="attr">core</span>:&#123;<span class="attr">name</span>:<span class="string">"abc"</span>&#125;, <span class="attr">user</span>:<span class="string">"Sam"</span>&#125;);</div></pre></td></tr></table></figure>
<p>If we destructure options inside param list, then we have to refer to the param as arguments[2]. What’s more, it seems to me confusing to have both default value for parameter and inside object destructuring. As a result, I perfer this style.<br>Also notice the support of nested structure (core:{name}).</p>
<h2 id="Create-array-like-object"><a href="#Create-array-like-object" class="headerlink" title="Create array-like object"></a>Create array-like object</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> myList = &#123;</div><div class="line">	<span class="attr">items</span>: [],</div><div class="line">	*[<span class="built_in">Symbol</span>.iterator]() &#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> <span class="keyword">this</span>.items) &#123;</div><div class="line">			<span class="keyword">yield</span> items[i];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">myList.items.push(<span class="number">1</span>);</div><div class="line">myList.items.push(<span class="number">2</span>);</div><div class="line">myList.items.push(<span class="number">3</span>);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> myList.items) &#123;</div><div class="line">	<span class="built_in">console</span>.log(item);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Don’t forget the comma at the end of items<br>Be careful about the compatible issue on different browsers</p>
<h2 id="Loop-through-a-Map"><a href="#Loop-through-a-Map" class="headerlink" title="Loop through a Map"></a>Loop through a Map</h2><p>The default iterator of Map returns [aKey, aValue] for each key. So it is possible to write for-loop like this:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [aKey, aValue] <span class="keyword">of</span> aMap) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;aKey&#125;</span> has the value <span class="subst">$&#123;aValue&#125;</span> `</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="for…in-vs-for…of"><a href="#for…in-vs-for…of" class="headerlink" title="for…in vs for…of"></a>for…in vs for…of</h2><p>The former is to loop properties, while the later is for iterator. for…of is also a solution to unicode text.<br>Something more about in operator<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Bad</span></div><div class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> obj[<span class="string">'aProperty'</span>] !== <span class="string">'undefined'</span>) &#123; </div><div class="line">  <span class="comment">//... </span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Good</span></div><div class="line"><span class="keyword">if</span> (<span class="string">'aProperty'</span> <span class="keyword">in</span> obj) &#123; <span class="comment">// or if (obj.hasOwnProperty('aProperty')) &#123;</span></div><div class="line">  <span class="comment">//... </span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Spread-Operator"><a href="#Spread-Operator" class="headerlink" title="Spread Operator"></a>Spread Operator</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> smallNumbers = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],</div><div class="line">		middleNumbers = [<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>],</div><div class="line">		largeNumbers = [<span class="number">100</span>,<span class="number">200</span>,<span class="number">300</span>],</div><div class="line">		allNumbers = [...smallNumbers,...middleNumbers,...largeNumbers];</div></pre></td></tr></table></figure>
<h2 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h2><h3 id="Understand-the-input-parameter-of-next"><a href="#Understand-the-input-parameter-of-next" class="headerlink" title="Understand the input parameter of next()"></a>Understand the input parameter of next()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">gen</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// XXX yield statement evaluates first before the variable assignment</span></div><div class="line">	<span class="keyword">let</span> v1 = <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">	<span class="keyword">let</span> v2 = <span class="keyword">yield</span> <span class="number">2</span> + v1;</div><div class="line">	<span class="keyword">let</span> v3 = <span class="keyword">yield</span> <span class="number">3</span> + v2;</div><div class="line">	<span class="keyword">yield</span> v3;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> values = gen();</div><div class="line"></div><div class="line"><span class="comment">// the main thread (MT) jumps into gen and jump out with value 1</span></div><div class="line"><span class="comment">// The first time of next() is special because the input "10" is assigned nowhere.</span></div><div class="line"><span class="built_in">console</span>.log(values.next(<span class="number">10</span>).value);</div><div class="line"></div><div class="line"><span class="comment">// MT jumps into gen again at the last place when gen jumped out.</span></div><div class="line"><span class="comment">// So 20 is assigned to v1 and then MT jumps out of gen with value 2+v1=22 </span></div><div class="line"><span class="built_in">console</span>.log(values.next(<span class="number">20</span>).value);</div><div class="line"></div><div class="line"><span class="comment">// MT throws an error, which cancels the whole gen.</span></div><div class="line"><span class="comment">// So v3 has NO value and there is no chance to do the last two yields</span></div><div class="line"><span class="built_in">console</span>.log(values.throw(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"WTF"</span>)).value);</div></pre></td></tr></table></figure>
<h3 id="Return-in-an-iterator-generator"><a href="#Return-in-an-iterator-generator" class="headerlink" title="Return in an iterator (generator)"></a>Return in an iterator (generator)</h3><p>Both spread operator and for…of can work with iterator.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">gen</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">return</span> <span class="number">55</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// case 1</span></div><div class="line"><span class="keyword">let</span> g = gen();</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> g) &#123;</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 1,2</span></div><div class="line"></div><div class="line"><span class="comment">// case 2</span></div><div class="line"><span class="keyword">let</span> g2 = gen();</div><div class="line"><span class="built_in">console</span>.log([...g2]); <span class="comment">// 1,2</span></div><div class="line"></div><div class="line"><span class="comment">// case 3</span></div><div class="line"><span class="keyword">let</span> g3 = gen();</div><div class="line"><span class="built_in">console</span>.log(g3.next().value); <span class="comment">// 1</span></div><div class="line"><span class="built_in">console</span>.log(g3.next().value); <span class="comment">// 2</span></div><div class="line"><span class="built_in">console</span>.log(g3.next().value); <span class="comment">// 55 (done is set because of return)</span></div><div class="line"><span class="built_in">console</span>.log(g3.next().value); <span class="comment">// undefined</span></div></pre></td></tr></table></figure></p>
<p>In the first two cases, they stop as soon as they see the done is set. The return value is ignored as a result.</p>
<h2 id="Singleton-Pattern-with-class-expression"><a href="#Singleton-Pattern-with-class-expression" class="headerlink" title="Singleton Pattern with class expression"></a>Singleton Pattern with class expression</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> Class &#123;</div><div class="line">  <span class="keyword">constructor</span>(name) &#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">  &#125;</div><div class="line">&#125;(<span class="string">"Sam"</span>);</div></pre></td></tr></table></figure>
<h2 id="Mixin-with-class-extend"><a href="#Mixin-with-class-extend" class="headerlink" title="Mixin with class extend"></a>Mixin with class extend</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> Foo = &#123;</div><div class="line">  doFoo() &#123;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> Bar = &#123;</div><div class="line">  doBar() &#123;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mixin</span>(<span class="params">...mixins</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> base = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</div><div class="line">  <span class="built_in">Object</span>.assign(base.prototype, ...mixins);</div><div class="line">  <span class="keyword">return</span> base;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Alien</span> <span class="keyword">extends</span> <span class="title">mixin</span>(<span class="title">Foo</span>, <span class="title">Bar</span>) </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> anAlien = <span class="keyword">new</span> Alien();</div><div class="line">anAlien.doFoo();</div><div class="line">anAlien.doBar();</div></pre></td></tr></table></figure>
<p>The point is a class can extend with an expression (mixin() in this case)</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/my-blog/tags/javascript/" rel="tag"># javascript</a>
          
            <a href="/my-blog/tags/ES2015/" rel="tag"># ES2015</a>
          
            <a href="/my-blog/tags/ES6/" rel="tag"># ES6</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/my-blog/2017/02/13/PPT-with-HTML/" rel="next" title="PPT with HTML">
                <i class="fa fa-chevron-left"></i> PPT with HTML
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/my-blog/2017/03/24/when-angular-meets-ngrx/" rel="prev" title="When Angular meets NgRx">
                When Angular meets NgRx <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://s.gravatar.com/avatar/67a6b6bab2f6f4fb0f035c398789a241?s=80"
               alt="Yuping Wang" />
          <p class="site-author-name" itemprop="name">Yuping Wang</p>
           
              <p class="site-description motion-element" itemprop="description">85608565</p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/my-blog/archives">
                <span class="site-state-item-count">18</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/my-blog/categories">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/my-blog/tags">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/sevenbamboos" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/sevenbamboos" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-better-length-method-for-unicode-text"><span class="nav-number">1.</span> <span class="nav-text">A better length method for unicode text</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Default-param"><span class="nav-number">2.</span> <span class="nav-text">Default param</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Apply-call-and-array-destructuring"><span class="nav-number">3.</span> <span class="nav-text">Apply, call and array destructuring</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#How-to-check-whether-a-function-is-called-with-“new”"><span class="nav-number">4.</span> <span class="nav-text">How to check whether a function is called with “new”</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Differences-between-arrow-function-and-normal-one"><span class="nav-number">5.</span> <span class="nav-text">Differences between arrow function and normal one</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Tail-call-optimization"><span class="nav-number">6.</span> <span class="nav-text">Tail call optimization</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Property-Initializer"><span class="nav-number">7.</span> <span class="nav-text">Property Initializer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Two-ways-to-clone-an-array"><span class="nav-number">8.</span> <span class="nav-text">Two ways to clone an array</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Make-the-last-param-optional-to-provide-multiple-configuration"><span class="nav-number">9.</span> <span class="nav-text">Make the last param optional to provide multiple configuration</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Create-array-like-object"><span class="nav-number">10.</span> <span class="nav-text">Create array-like object</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Loop-through-a-Map"><span class="nav-number">11.</span> <span class="nav-text">Loop through a Map</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#for…in-vs-for…of"><span class="nav-number">12.</span> <span class="nav-text">for…in vs for…of</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spread-Operator"><span class="nav-number">13.</span> <span class="nav-text">Spread Operator</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Generator"><span class="nav-number">14.</span> <span class="nav-text">Generator</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Understand-the-input-parameter-of-next"><span class="nav-number">14.1.</span> <span class="nav-text">Understand the input parameter of next()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Return-in-an-iterator-generator"><span class="nav-number">14.2.</span> <span class="nav-text">Return in an iterator (generator)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Singleton-Pattern-with-class-expression"><span class="nav-number">15.</span> <span class="nav-text">Singleton Pattern with class expression</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mixin-with-class-extend"><span class="nav-number">16.</span> <span class="nav-text">Mixin with class extend</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yuping Wang</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/my-blog/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/my-blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/my-blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/my-blog/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/my-blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/my-blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/my-blog/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/my-blog/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/my-blog/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/my-blog/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/my-blog/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  

  

  

  


  

</body>
</html>
