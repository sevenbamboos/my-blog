<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ES2015 | Sam&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="A better length method for unicode text1234function codePointLen(text) &amp;#123;  let result = text.match(/[\s\S]/gu);  return result ? result.length : 0;&amp;#125;
Default paramA trivial version1234function">
<meta property="og:type" content="article">
<meta property="og:title" content="ES2015">
<meta property="og:url" content="https://sevenbamboos.github.com/2017/02/27/ES-2015/index.html">
<meta property="og:site_name" content="Sam's Blog">
<meta property="og:description" content="A better length method for unicode text1234function codePointLen(text) &amp;#123;  let result = text.match(/[\s\S]/gu);  return result ? result.length : 0;&amp;#125;
Default paramA trivial version1234function">
<meta property="og:updated_time" content="2017-02-28T15:05:49.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ES2015">
<meta name="twitter:description" content="A better length method for unicode text1234function codePointLen(text) &amp;#123;  let result = text.match(/[\s\S]/gu);  return result ? result.length : 0;&amp;#125;
Default paramA trivial version1234function">
  
    <link rel="alternate" href="/atom.xml" title="Sam&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/my-blog/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/my-blog/" id="logo">Sam&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/my-blog/">Home</a>
        
          <a class="main-nav-link" href="/my-blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://sevenbamboos.github.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-ES-2015" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/my-blog/2017/02/27/ES-2015/" class="article-date">
  <time datetime="2017-02-27T14:59:32.000Z" itemprop="datePublished">02-27-2017</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ES2015
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="A-better-length-method-for-unicode-text"><a href="#A-better-length-method-for-unicode-text" class="headerlink" title="A better length method for unicode text"></a>A better length method for unicode text</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">codePointLen</span>(<span class="params">text</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> result = text.match(<span class="regexp">/[\s\S]/gu</span>);</div><div class="line">  <span class="keyword">return</span> result ? result.length : <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Default-param"><a href="#Default-param" class="headerlink" title="Default param"></a>Default param</h2><p>A trivial version<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getID</span>(<span class="params">name, defaultValue</span>) </span>&#123;</div><div class="line">  defaultValue = defaultValue || <span class="number">1000</span>;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>The problem is defaultValue would be ignored with falsy value like 0. As a result, a more decent version before ES2015 is<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getID</span>(<span class="params">name, defaultValue</span>) </span>&#123;</div><div class="line">  defaultValue = (<span class="keyword">typeof</span> defaultValue !== <span class="string">"undefined"</span>) ? defaultValue : <span class="number">0</span>;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>In ES2015, it can be simplified as<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getID</span>(<span class="params">name, defaultValue=<span class="number">1000</span></span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Apply-call-and-array-destructuring"><a href="#Apply-call-and-array-destructuring" class="headerlink" title="Apply, call and array destructuring"></a>Apply, call and array destructuring</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> values = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>];</div><div class="line"></div><div class="line"><span class="comment">// Because Math.max doesn't accept array. Please remember that "call" accepts multiple params and do the same function invocation as "apply" </span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.max.apply(<span class="built_in">Math</span>, values));</div><div class="line"></div><div class="line"><span class="comment">// The first param can be anything since max is a pure function (instead of a method)</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.max.apply(<span class="literal">null</span>, values));</div><div class="line"></div><div class="line"><span class="comment">// But it's easier with array destructuring</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.max(...values));</div></pre></td></tr></table></figure>
<h2 id="How-to-check-whether-a-function-is-called-with-“new”"><a href="#How-to-check-whether-a-function-is-called-with-“new”" class="headerlink" title="How to check whether a function is called with “new”"></a>How to check whether a function is called with “new”</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">this</span> <span class="keyword">instanceof</span> Person) &#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Call Person with new, please"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> Person(<span class="string">"tom"</span>);</div><div class="line"></div><div class="line"><span class="comment">// It can be checked by Person and throw the error</span></div><div class="line"><span class="comment">// let p2 = Person("jerry");</span></div><div class="line"></div><div class="line"><span class="comment">// No error with this call </span></div><div class="line"><span class="keyword">let</span> p2 = Person.call(p1, <span class="string">"jerry"</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(p1.name); <span class="comment">//jerry</span></div><div class="line"><span class="built_in">console</span>.log(p2); <span class="comment">//undefined</span></div></pre></td></tr></table></figure>
<p>ES2015 fixes the issue with:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="comment">// "new.target" is not supported in safari (on iPhone, iPad and Mac)</span></div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">new</span>.target !== <span class="string">"undefined"</span>) &#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Call Person with new, please"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Note that if we can modify the above comparison to create an abstract class<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="keyword">new</span>.target === Person) </div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Abstract class Person can't be initilized directly"</span>);</div></pre></td></tr></table></figure></p>
<h2 id="Differences-between-arrow-function-and-normal-one"><a href="#Differences-between-arrow-function-and-normal-one" class="headerlink" title="Differences between arrow function and normal one"></a>Differences between arrow function and normal one</h2><ul>
<li>No this, super and new.target bindings; No prototype and arguments</li>
<li>Can’t be called with new (since arrow function doesn’t have [[Construct]], only [[Call]])</li>
<li>Can’t change this, which remains the same throughout the life cycle of the function</li>
</ul>
<h2 id="Tail-call-optimization"><a href="#Tail-call-optimization" class="headerlink" title="Tail call optimization"></a>Tail call optimization</h2><p>In theory, the optimization is enabled when the tail call has no dependency to the current stack and there is no further work to do after the call, plus the call must return as the function value. So this won’t be optimized:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fact</span>(<span class="params">n</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> n * fact(n<span class="number">-1</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>In fact, I notice it is quite efficient (in safari on Mac). fact(170), the maximum param making the result less than infinity, is as fast as below, which is regarded as optimized:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fact</span>(<span class="params">n, p=<span class="number">1</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>*p;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> fact(n<span class="number">-1</span>, n*p);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Here is another example:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fibo</span>(<span class="params">n, i=<span class="number">2</span>, p1=<span class="number">1</span>, p2=<span class="number">1</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"param n can't be less than zero"</span>);</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">2</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">if</span> (n === i) &#123;</div><div class="line">      <span class="keyword">return</span> p1 + p2;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> fibo(n, i+<span class="number">1</span>, p1+p2, p1);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Property-Initializer"><a href="#Property-Initializer" class="headerlink" title="Property Initializer"></a>Property Initializer</h2><p>No need in ES2015 to repeat the value assignment for each property. The eigine will look for the variable in the surrounding context with the same name and do the job.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPerson</span>(<span class="params">name, age</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    name,</div><div class="line">    age</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Two-ways-to-clone-an-array"><a href="#Two-ways-to-clone-an-array" class="headerlink" title="Two ways to clone an array"></a>Two ways to clone an array</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> list = [<span class="string">"dog"</span>, <span class="string">"cat"</span>, <span class="string">"Sam"</span>];</div><div class="line"><span class="keyword">let</span> another = list.concat();</div><div class="line"><span class="keyword">let</span> second = [...list];</div></pre></td></tr></table></figure>
<h2 id="Make-the-last-param-optional-to-provide-multiple-configuration"><a href="#Make-the-last-param-optional-to-provide-multiple-configuration" class="headerlink" title="Make the last param optional to provide multiple configuration"></a>Make the last param optional to provide multiple configuration</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">config</span>(<span class="params">id, value, options = &#123;&#125;</span>) </span>&#123;</div><div class="line">	<span class="keyword">let</span> &#123;<span class="attr">core</span>:&#123;name&#125;, time=<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.now()), user=<span class="string">"Unknown User"</span>&#125; = options; </div><div class="line">	<span class="keyword">return</span> &#123;name,time,user&#125;;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> options = config(<span class="number">1</span>, <span class="string">"abc"</span>, &#123;<span class="attr">core</span>:&#123;<span class="attr">name</span>:<span class="string">"abc"</span>&#125;, <span class="attr">user</span>:<span class="string">"Sam"</span>&#125;);</div></pre></td></tr></table></figure>
<p>If we destructure options inside param list, then we have to refer to the param as arguments[2]. What’s more, it seems to me confusing to have both default value for parameter and inside object destructuring. As a result, I perfer this style.<br>Also notice the support of nested structure (core:{name}).</p>
<h2 id="Create-array-like-object"><a href="#Create-array-like-object" class="headerlink" title="Create array-like object"></a>Create array-like object</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> myList = &#123;</div><div class="line">	<span class="attr">items</span>: [],</div><div class="line">	*[<span class="built_in">Symbol</span>.iterator]() &#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> <span class="keyword">this</span>.items) &#123;</div><div class="line">			<span class="keyword">yield</span> items[i];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">myList.items.push(<span class="number">1</span>);</div><div class="line">myList.items.push(<span class="number">2</span>);</div><div class="line">myList.items.push(<span class="number">3</span>);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> myList.items) &#123;</div><div class="line">	<span class="built_in">console</span>.log(item);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Don’t forget the comma at the end of items<br>Be careful about the compatible issue on different browsers</p>
<h2 id="Loop-through-a-Map"><a href="#Loop-through-a-Map" class="headerlink" title="Loop through a Map"></a>Loop through a Map</h2><p>The default iterator of Map returns [aKey, aValue] for each key. So it is possible to write for-loop like this:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [aKey, aValue] <span class="keyword">of</span> aMap) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;aKey&#125;</span> has the value <span class="subst">$&#123;aValue&#125;</span> `</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="for…in-vs-for…of"><a href="#for…in-vs-for…of" class="headerlink" title="for…in vs for…of"></a>for…in vs for…of</h2><p>The former is to loop properties, while the later is for iterator. for…of is also a solution to unicode text.</p>
<h2 id="Spread-Operator"><a href="#Spread-Operator" class="headerlink" title="Spread Operator"></a>Spread Operator</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> smallNumbers = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],</div><div class="line">		middleNumbers = [<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>],</div><div class="line">		largeNumbers = [<span class="number">100</span>,<span class="number">200</span>,<span class="number">300</span>],</div><div class="line">		allNumbers = [...smallNumbers,...middleNumbers,...largeNumbers];</div></pre></td></tr></table></figure>
<h2 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h2><h3 id="Understand-the-input-parameter-of-next"><a href="#Understand-the-input-parameter-of-next" class="headerlink" title="Understand the input parameter of next()"></a>Understand the input parameter of next()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">gen</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// XXX yield statement evaluates first before the variable assignment</span></div><div class="line">	<span class="keyword">let</span> v1 = <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">	<span class="keyword">let</span> v2 = <span class="keyword">yield</span> <span class="number">2</span> + v1;</div><div class="line">	<span class="keyword">let</span> v3 = <span class="keyword">yield</span> <span class="number">3</span> + v2;</div><div class="line">	<span class="keyword">yield</span> v3;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> values = gen();</div><div class="line"></div><div class="line"><span class="comment">// the main thread (MT) jumps into gen and jump out with value 1</span></div><div class="line"><span class="comment">// The first time of next() is special because the input "10" is assigned nowhere.</span></div><div class="line"><span class="built_in">console</span>.log(values.next(<span class="number">10</span>).value);</div><div class="line"></div><div class="line"><span class="comment">// MT jumps into gen again at the last place when gen jumped out.</span></div><div class="line"><span class="comment">// So 20 is assigned to v1 and then MT jumps out of gen with value 2+v1=22 </span></div><div class="line"><span class="built_in">console</span>.log(values.next(<span class="number">20</span>).value);</div><div class="line"></div><div class="line"><span class="comment">// MT throws an error, which cancels the whole gen.</span></div><div class="line"><span class="comment">// So v3 has NO value and there is no chance to do the last two yields</span></div><div class="line"><span class="built_in">console</span>.log(values.throw(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"WTF"</span>)).value);</div></pre></td></tr></table></figure>
<h3 id="Return-in-an-iterator-generator"><a href="#Return-in-an-iterator-generator" class="headerlink" title="Return in an iterator (generator)"></a>Return in an iterator (generator)</h3><p>Both spread operator and for…of can work with iterator.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">gen</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">return</span> <span class="number">55</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// case 1</span></div><div class="line"><span class="keyword">let</span> g = gen();</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> g) &#123;</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 1,2</span></div><div class="line"></div><div class="line"><span class="comment">// case 2</span></div><div class="line"><span class="keyword">let</span> g2 = gen();</div><div class="line"><span class="built_in">console</span>.log([...g2]); <span class="comment">// 1,2</span></div><div class="line"></div><div class="line"><span class="comment">// case 3</span></div><div class="line"><span class="keyword">let</span> g3 = gen();</div><div class="line"><span class="built_in">console</span>.log(g3.next().value); <span class="comment">// 1</span></div><div class="line"><span class="built_in">console</span>.log(g3.next().value); <span class="comment">// 2</span></div><div class="line"><span class="built_in">console</span>.log(g3.next().value); <span class="comment">// 55 (done is set because of return)</span></div><div class="line"><span class="built_in">console</span>.log(g3.next().value); <span class="comment">// undefined</span></div></pre></td></tr></table></figure></p>
<p>In the first two cases, they stop as soon as they see the done is set. The return value is ignored as a result.</p>
<h2 id="Singleton-Pattern-with-class-expression"><a href="#Singleton-Pattern-with-class-expression" class="headerlink" title="Singleton Pattern with class expression"></a>Singleton Pattern with class expression</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> Class &#123;</div><div class="line">  <span class="keyword">constructor</span>(name) &#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">  &#125;</div><div class="line">&#125;(<span class="string">"Sam"</span>);</div></pre></td></tr></table></figure>
<h2 id="Mixin-with-class-extend"><a href="#Mixin-with-class-extend" class="headerlink" title="Mixin with class extend"></a>Mixin with class extend</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> Foo = &#123;</div><div class="line">  doFoo() &#123;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> Bar = &#123;</div><div class="line">  doBar() &#123;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mixin</span>(<span class="params">...mixins</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> base = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</div><div class="line">  <span class="built_in">Object</span>.assign(base.prototype, ...mixins);</div><div class="line">  <span class="keyword">return</span> base;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Alien</span> <span class="keyword">extends</span> <span class="title">mixin</span>(<span class="title">Foo</span>, <span class="title">Bar</span>) </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> anAlien = <span class="keyword">new</span> Alien();</div><div class="line">anAlien.doFoo();</div><div class="line">anAlien.doBar();</div></pre></td></tr></table></figure>
<p>The point is a class can extend with an expression (mixin() in this case)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sevenbamboos.github.com/my-blog/2017/02/27/ES-2015/" data-id="cizpo7g2k00005km68a1nvg7y" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/my-blog/tags/Programming/">Programming</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/my-blog/2017/02/13/PPT-with-HTML/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">PPT with HTML</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/my-blog/tags/Programming/">Programming</a></li><li class="tag-list-item"><a class="tag-list-link" href="/my-blog/tags/Tool/">Tool</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/my-blog/tags/Programming/" style="font-size: 10px;">Programming</a> <a href="/my-blog/tags/Tool/" style="font-size: 20px;">Tool</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/my-blog/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/my-blog/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/my-blog/archives/2016/06/">June 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/my-blog/2017/02/27/ES-2015/">ES2015</a>
          </li>
        
          <li>
            <a href="/my-blog/2017/02/13/PPT-with-HTML/">PPT with HTML</a>
          </li>
        
          <li>
            <a href="/my-blog/2017/02/13/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/my-blog/2017/01/09/Hexo/">Hexo - How to publish site on Github</a>
          </li>
        
          <li>
            <a href="/my-blog/2016/06/09/entity-framework-code-first/">Code First in Entity framework</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Yuping Wang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/my-blog/" class="mobile-nav-link">Home</a>
  
    <a href="/my-blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/my-blog/fancybox/jquery.fancybox.css">
  <script src="/my-blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/my-blog/js/script.js"></script>

  </div>
</body>
</html>